From 5b1cdafb83eea2a48225859781dd39b4c526399c Mon Sep 17 00:00:00 2001
From: Carmine Scarpitta <cscarpit@cisco.com>
Date: Thu, 14 Aug 2025 07:24:42 +0000
Subject: zebra: Add missing debug guard in if netlink code

Guard a debug in the if netlink code.

Signed-off-by: Carmine Scarpitta <cscarpit@cisco.com>
---
 zebra/if_netlink.c | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

diff --git a/zebra/if_netlink.c b/zebra/if_netlink.c
index 7d31684c56..a214914171 100644
--- a/zebra/if_netlink.c
+++ b/zebra/if_netlink.c
@@ -1278,8 +1278,9 @@ int netlink_link_change(struct nlmsghdr *h, ns_id_t ns_id, int startup)
 
 	if (!(h->nlmsg_type == RTM_NEWLINK || h->nlmsg_type == RTM_DELLINK)) {
 		/* If this is not link add/delete message so print warning. */
-		zlog_debug("%s: wrong kernel message %s", __func__,
-			   nl_msg_type_to_str(h->nlmsg_type));
+		if (IS_ZEBRA_DEBUG_KERNEL)
+			zlog_debug("%s: wrong kernel message %s", __func__,
+				   nl_msg_type_to_str(h->nlmsg_type));
 		return 0;
 	}
 
-- 
2.48.1

